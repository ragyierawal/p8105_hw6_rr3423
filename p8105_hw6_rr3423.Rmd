---
title: "p8105_hw6_rr3423.Rmd"
author: "Ragyie Rawal"
output: github_document
---

```{r setup, include = FALSE}
library(tidyverse)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```


## PROBLEM 1 

### Loading data for regression analysis 

```{r import_data}
# loading data
birthweight_data = read_csv("data/birthweight.csv")
```

### Checking for missing data by identifying any NA values in columns 

```{r check_NA}
# checking for NA values 
birthweight_data %>% 
  summarise(across(everything(), ~ sum(is.na(.))))
```

There are no NA values, thus no missing data in the birthweight dataset. 

### Converting numeric to factor variables for regression analysis 

Determining the class of each variable in the birthweight dataset:

```{r variable_class}
# checking class of each variable
birthweight_data %>% 
  map(class)
```

All of the variables in the birthweight dataset are numeric. 

There are four numeric categorical variables in the dataset which should be converted to factor variables (based on the homework dataset description): babysex, frace, malform. and mrace. 

Checking the distinct categories in each variable: 

```{r distinct_categories}
birthweight_data %>% 
  distinct(babysex)

birthweight_data %>% 
  distinct(frace)

birthweight_data %>% 
  distinct(malform)

birthweight_data %>% 
  distinct(mrace)
```

The babysex variable has two distinct categories, which are consistent with the homework data description. The frace variable only has five distinct categories, which are not consistent with the homework data description (category 9 'unknown' is not included in this dataset). The malform variable has two distinct categories, which are consistent with the homework data description. The mrace variable only has four distinct categories, which are not consistent with the homework data description (category 8 'other' is not included in this dataset). 

Converting the numeric variables to factor variables to tidy the data for regression analysis: 

```{r tidy_data}
birthweight_df = 
  birthweight_data %>% 
  janitor::clean_names() %>% 
  mutate(
    babysex = recode(babysex, "1" = "male", "2" = "female"),
    babysex = factor(babysex, levels = c("male", "female")),
    frace = recode(frace, "1" = "White", "2" = "Black", "3" = "Asian",
                   "4" = "Puerto Rican", "8" = "Other"),
    frace = factor(frace, levels = c("White", "Black", "Asian",
                                     "Puerto Rican", "Other")),
    malform = recode(malform, "0" = "absent", "1" = "present"),
    malform = factor(malform, levels = c("absent", "present")),
    mrace = recode(mrace, "1" = "White", "2" = "Black", 
                   "3" = "Asian", "4" = "Puerto Rican"),
    mrace = factor(mrace, levels = c("White", "Black", "Asian", "Puerto Rican"))
  )
```

### Describing the birthweight dataset 

```{r describing_data}
variables_bw = 
  birthweight_df %>% 
  names()

rows_bw = 
  birthweight_df %>% 
  nrow()

columns_bw = 
  birthweight_df %>% 
  ncol()
```

The **key variables** in the birthweight dataset are `r variables_bw`. The **number of rows** in the birthweight dataset `r rows_bw`. The **number of columns** in the birthweight dataset is `r columns_bw`. 

### Proposing a regression model for birthweight 

I am hypothesizing that the following variables are factors that underly birthweight, so birthweight might depend on these factors: family income (fincome), gestational age in weeks (gaweeks), mother's age at delivery in years (momage), mother's race (mrace), and mother's weight gain during pregnancy in pounds (wtgain). 

My proposed regression model for birthweight is: 

```{r proposed_model}
fit = lm(bwt ~ fincome + gaweeks + momage + mrace + wtgain, data = birthweight_df)
```


